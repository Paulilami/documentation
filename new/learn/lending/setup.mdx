---
title: "Setup"
description: "Deploy and configure your first lending market"
---

Setting up a lending market involves deploying contracts, configuring the oracle, and setting risk parameters. The Issuers App handles most complexity—you'll configure options through the interface while we deploy and wire up the contracts.

## Prerequisites

Before creating a lending market, ensure you have:

<CardGroup cols={2}>
    <Card title="Tokenized Asset" icon="coins">
        A deployed security token (stock, commodity, or other asset) that will serve as collateral
    </Card>
    <Card title="Instance Access" icon="key">
        Active Trusset instance with appropriate permissions
    </Card>
    <Card title="Wallet Configuration" icon="wallet">
        Admin and issuer wallet addresses for role assignment
    </Card>
    <Card title="Initial Price" icon="chart-line">
        Current market price for the collateral asset
    </Card>
</CardGroup>

## Creating a Market

<Steps>
    <Step title="Navigate to Lending">
        In your Issuers App, go to **Issuance → Lending Markets** and click **Add Market**
    </Step>
    <Step title="Select Asset Type">
        Choose the tab matching your collateral (Gold, Stocks, etc.) and click **Create Market**
    </Step>
    <Step title="Configure Basic Settings">
        Enter:
        - **Stock Token**: Your tokenized asset (click on fetched asset)
        - **Issuer Address**: Comes automatically from connected address
        - **Initial Price**: Current asset price in USD (sync automatically from price feeds)
    </Step>
    <Step title="Set Risk Parameters">
        Configure collateralization settings:
        - **Collateral Factor**: 75% recommended for liquid assets
        - **Liquidation Threshold**: 85% provides 10% safety buffer
        - **Liquidation Bonus**: 5% incentivizes timely liquidations
    </Step>
    <Step title="Deploy">
        Click **Create Market**. The system deploys:
        - Lending market contract
        - Price oracle
        - Insurance fund
        - Connects to liquidation router
    </Step>
</Steps>

## Post-Deployment Configuration

After deployment, complete these configuration steps:

### 1. Authorize Stock Token

Your stock tokens will automatically whitelist your lending contracts when deploying them. If you use an external token, the lending market needs permission to transfer your security tokens during collateral operations.

<Tabs>
    <Tab title="From Issuers App">
        Navigate to your market's **Settings** tab. If stock token authorization is pending, you'll see an alert with the required action.
        
        Click **View Configuration Status** to see which authorizations are needed, then execute the provided transactions from your issuer wallet.
    </Tab>
    <Tab title="Required Authorizations">
        Two authorizations are typically needed:
        
        1. **Market Authorization**: Allows the lending market to receive and return collateral
        2. **Router Authorization**: Allows the liquidation router to handle seized collateral
        
        Both require calling `addAgent()` on your security token with the respective contract addresses.
    </Tab>
</Tabs>

### 2. Configure Oracle

The price oracle needs authorization and an initial price update.

<AccordionGroup>
    <Accordion title="Authorize Backend Signer">
        Our backend can sign price updates, enabling gasless price synchronization. To authorize:
        
        1. Connect with the oracle owner wallet
        2. Click **Authorize Signer** in the market alert
        3. Sign the authorization message
        
        This allows automatic price updates without manual transactions.
    </Accordion>
    <Accordion title="Sync Initial Price">
        After signer authorization, click **Sync Oracle** to update the on-chain price. The system fetches the current price from pre-configured feeds and submits it to the oracle.
        
        Without a valid oracle price, users cannot borrow. If no custom price is configured, we will use our internal price feeds.
    </Accordion>
    <Accordion title="Custom Price Feeds">
        By default, markets use Alpha Vantage for stock prices. Configure a custom feed in **Settings → Custom Price Feed**:
```
        https://your-api.com/price?symbol={symbol}
```
        
        The `{symbol}` placeholder is replaced with your asset's ticker. Response must include one of: `price`, `c`, `last`, or `regularMarketPrice`.
    </Accordion>
</AccordionGroup>

### 3. Configure Insurance Fund

The insurance fund protects against bad debt. Configuration happens automatically during deployment, but verify in Settings that the insurance fund address is set.

### 4. Configure Liquidation

<Info>
Liquidation is pre-configured to use Trusset's shared liquidation router, which routes seized collateral to your configured trading venue. See [Liquidation](/new/learn/lending/liquidation) for custom liquidation contract integration.
</Info>

The default setup:
- Liquidated collateral → Liquidation Router → Trading Venue (Orderbook Custody Contract)
- USDC proceeds → Liquidation Router → Lending Pool

## Configuration Status

The **Configuration Status** panel shows what's complete and what needs attention:

| Status | Meaning |
|--------|---------|
| ✅ Market On-Chain | Contract deployed successfully |
| ✅ Oracle Configured | Price oracle has valid price |
| ✅ Signer Authorized | Backend can update prices |
| ✅ Liquidation Configured | Router authorized and ready |
| ✅ Stock Token Authorized | Market can handle collateral |

All items should be green before the market is production-ready.

## Risk Parameter Guidelines

<Tabs>
    <Tab title="Conservative">
        For volatile or less liquid assets:
        
        | Parameter | Value |
        |-----------|-------|
        | Collateral Factor | 65% |
        | Liquidation Threshold | 75% |
        | Liquidation Bonus | 8% |
        | Close Factor | 25% |
        
        Provides large safety margins but limits borrowing power.
    </Tab>
    <Tab title="Moderate">
        For established, liquid assets:
        
        | Parameter | Value |
        |-----------|-------|
        | Collateral Factor | 75% |
        | Liquidation Threshold | 85% |
        | Liquidation Bonus | 5% |
        | Close Factor | 50% |
        
        Balanced approach suitable for most tokenized securities.
    </Tab>
    <Tab title="Aggressive">
        For highly liquid, stable assets (e.g., tokenized gold):
        
        | Parameter | Value |
        |-----------|-------|
        | Collateral Factor | 80% |
        | Liquidation Threshold | 90% |
        | Liquidation Bonus | 3% |
        | Close Factor | 50% |
        
        Maximizes capital efficiency with tighter margins.
    </Tab>
</Tabs>

## Supply Caps

Set limits to manage market exposure:

| Cap | Recommendation |
|-----|----------------|
| Max Total Collateral | Start conservative (e.g., $1M), increase as market matures |
| Max User Collateral | 10-20% of total cap prevents concentration |

Caps can be updated anytime through Settings without contract redeployment.

## Dutch Auction Settings

If using Dutch auction liquidations (recommended for larger markets):

| Setting | Description | Recommended |
|---------|-------------|-------------|
| Enable Dutch Auction | Toggle auction vs instant liquidation | Yes for markets > $100k |
| Auction Duration | Time to reach minimum price | 1-24 hours |
| Start Premium | Initial price above oracle | 120-130% |
| Minimum Premium | Floor price | 95-100% |

Auctions give liquidators time to participate and typically result in better prices than instant liquidations.

## Whitelabel Approval

Before your market appears in whitelabel applications, toggle **Approved for Whitelabel** in the market list. This controls visibility in the Borrow Module.

<CardGroup cols={2}>
    <Card title="Management" icon="sliders" href="/new/learn/lending/management">
        Day-to-day operations and monitoring
    </Card>
    <Card title="Liquidation" icon="gavel" href="/new/learn/lending/liquidation">
        Configure liquidation handling
    </Card>
</CardGroup>
---
title: "Stock Tokenization"
description: "Transform traditional equity positions into blockchain tokens with 1:1 backing"
---

## Architecture

The stock tokenization engine operates through a three-phase process that maintains strict custody verification and compliance with the German eWpG.

### Position Lifecycle

<Steps>
  <Step title="Position Locking">
    Custodian confirms physical share custody through API verification. Lock receipt generates unique identifier `LOCK-{timestamp}-{hash}` for tracking. Position is registered in the crypto-securities register and remains immobilized until burn transaction occurs.
  </Step>
  
  <Step title="Token Minting">
    Factory contract deploys ERC20 token with snapshot capability. Minting occurs at 1:1 ratio with 18 decimal precision. Token address deterministically derived from stock ISIN and linked to the eWpG register entry.
  </Step>
  
  <Step title="Position Unlocking">
    Burn transaction destroys tokens on-chain. Custodian receives unlock instruction with burn proof. Register entry is updated and physical shares released to the original holder. A token is convertible 1:1 with the registered stock position.
  </Step>
</Steps>


## Economic Model

### Supply Mechanics

Token supply directly corresponds to locked positions. No fractional reserve or synthetic creation permitted.

```
Total Supply = Σ(Locked Positions)
Circulating Supply = Total Supply - Burned Tokens
```

### Stock Split Mathematics

For ratio `r` and divisor `d`:

**Forward split (r > d)**: 
```
New Balance = Current Balance × (r/d)
Additional Tokens = Current Balance × ((r-d)/d)
```

**Reverse split (r < d)**:
```
New Balance = Current Balance × (r/d)
Burn Amount = Current Balance × (1 - r/d)
```

### Dividend Distribution

Entitlement calculated via snapshot mechanism:

```
Individual Payment = (Total Dividend × Holder Balance) / Total Supply at Snapshot
```

Payment execution requires:
- Snapshot ID from declaration block
- Payment token address (USDC, USDT, etc.)
- Holder balance verification at snapshot height
- Claim submission before expiry (typically 90 days)

## Operational Flow

<Card title="Custody Verification" icon="lock">
  **Lock Validation**: 60-second timeout for custodian API confirmation
  
  **Required Fields**: ISIN, quantity, holder ID, custodian reference
  
  **Retry Logic**: 3 attempts with exponential backoff (2s, 4s, 8s)
</Card>

<Card title="Token Lifecycle" icon="coins">
  **Minting Latency**: 15-30 seconds for blockchain confirmation
  
  **Trading Venue**: Immediate availability on regulated markets or DLT Pilot platforms post-mint
  
  **Redemption Time**: 2-4 hours for custodian processing and register update
</Card>


### Corporate Action Automation

<AccordionGroup>
  <Accordion title="Stock Splits">
    Scheduled via `CorporateActionsModule` with T+2 settlement. Snapshot taken at execution block. Balance adjustments occur atomically.
  </Accordion>
  
  <Accordion title="Dividend Payments">
    Declaration creates snapshot ID. Payment date enforced on-chain. Unclaimed dividends return to treasury after 90 days.
  </Accordion>
  
  <Accordion title="Trading Halts">
    `pauseTrading()` freezes all transfers except corporate actions. Resume requires governance approval. Halt events emit to all connected exchanges.
  </Accordion>
  
  <Accordion title="Delistings">
    Permanent freeze with forced redemption period. 30-day window for token burns. Remaining tokens become non-transferable.
  </Accordion>
</AccordionGroup>

## Risk Considerations

<Warning>
  **Custodian Dependency**: Total reliance on custodian solvency and operational integrity. No on-chain recovery mechanism for custodian default.
</Warning>

<Note>
  **Oracle Requirements**: Price feeds from unified oracle for liquidations. Corporate action data requires manual verification. 15-minute maximum staleness for critical operations.
</Note>

### Failure Modes

| Risk | Probability | Impact | Mitigation |
|------|------------|---------|------------|
| Custodian API outage | Medium | Minting delays | Scheduled minting queue, 24h retry window |
| Double-spend attempt | Low | Token inflation | Lock verification, unique nonces |
| Corporate action miss | Low | Incorrect balances | Multi-signature execution, time delays |
| Oracle manipulation | Very Low | Price distortion | Multiple feed aggregation, circuit breakers |

### Recovery Mechanisms

**Failed Mints**: Automatic retry with exponential backoff. Manual intervention after 5 failures. Lock release after 24 hours.

**Stuck Positions**: Emergency unlock via multisig after 72 hours. Requires 3/5 keeper signatures. Emits security alert.

**Contract Bugs**: Upgradeable proxy pattern (ERC1967). 48-hour timelock on upgrades. Requires governance vote.

## Dependencies

### External Systems
- **Custodian APIs**: REST endpoints with HMAC authentication
- **Price Oracles**: Chainlink for major stocks, custom feeds for others
- **Regulatory Reporting**: Daily position reconciliation to authorities
- **Identity Verification**: KYC provider integration for holder validation

### Internal Modules
- **PositionManager**: Tracks custody states and lock records
- **StockTokenFactory**: Deterministic token deployment
- **CorporateActionsModule**: Schedules and executes stock events
- **DividendDistributor**: Manages payment pools and distributions

### Integration Requirements

<Tabs>
  <Tab title="Custodian">
    ```
    POST /api/v1/positions/lock
    Authorization: Bearer {api_key}
    
    {
      "isin": "US0378331005",
      "quantity": 1000,
      "holder_id": "client_123",
      "reference": "LOCK-1234567890-abc"
    }
    ```
    
    Response confirms within 60 seconds or times out.
  </Tab>
  
  <Tab title="Oracle">
    ```
    GET /api/v1/price/{isin}
    
    {
      "price": 15823, // cents
      "timestamp": 1634567890,
      "signature": "0x..."
    }
    ```
    
    Maximum staleness: 900 seconds (15 minutes).
  </Tab>
  
  <Tab title="Regulatory">
    ```
    POST /api/v1/report/positions
    
    {
      "date": "2024-01-01",
      "positions": [...],
      "signature": "0x..."
    }
    ```
    
    Daily submission by 23:59 UTC.
  </Tab>
</Tabs>
